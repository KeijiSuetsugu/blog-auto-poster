# 🔐 認証エラー「Invalid username or token」の解決法

## エラーメッセージ

```
remote: Invalid username or token.
Password authentication is not supported for Git operations.
fatal: Authentication failed
```

## 原因

1. **トークンが間違っている**（コピー漏れ、余分なスペースなど）
2. **ユーザー名が間違っている**
3. **古いトークンを使っている**（期限切れ、または権限不足）
4. **パスワードを入力してしまった**（トークンではなく）

## ✅ 解決方法（ステップバイステップ）

### ステップ1: 新しいPersonal Access Tokenを作成（確実な方法）

#### 1. GitHubでトークン作成ページを開く

ブラウザで以下を開く：
```
https://github.com/settings/tokens
```

#### 2. 古いトークンを削除（あれば）

- 古いトークンがある場合、「Delete」ボタンで削除してもOK
- 削除しなくてもOK

#### 3. 新しいトークンを作成

1. 「Generate new token」→「Generate new token (classic)」をクリック

2. **設定を入力：**
   - **Note**: 「ブログ投稿用（workflow権限付き）」など何でもOK
   - **Expiration**: 好みで（長期間なら「No expiration」）

3. **権限（Select scopes）を設定：**
   - ✅ **`repo`** - チェックボックスをクリック（すべてのサブ項目も自動でチェックされます）
   - ✅ **`workflow`** - チェックボックスをクリック（重要！）

4. 画面を下にスクロールして「**Generate token**」ボタンをクリック

5. **表示されたトークンをコピー**
   - ⚠️ **必ず全部コピーしてください**
   - トークンは `ghp_` で始まる長い文字列です
   - 例：`ghp_abcdefghijklmnopqrstuvwxyz1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ`
   - 一度しか表示されないので、メモ帳に貼り付けて保存するのも良いです

### ステップ2: ターミナルでクリアにする

#### 方法1: 認証情報をクリア（推奨）

ターミナルで以下を実行して、保存されている認証情報をクリア：

```bash
git credential-osxkeychain erase
host=github.com
protocol=https
```

（Enterキーを2回押す）

#### 方法2: 一度ターミナルを閉じて再度開く

ターミナルアプリを完全に閉じて、もう一度開く

### ステップ3: 再度プッシュを試す

ターミナルで以下を実行：

```bash
git push origin main
```

### ステップ4: 認証情報を正確に入力

#### 1. ユーザー名を入力

「Username for 'https://github.com':」と表示されたら：

- **GitHubのユーザー名**を正確に入力
- 例：`KeijiSuetsugu`
- ⚠️ **ディレクトリのパスは入力しない**
- Enterキーを押す

#### 2. パスワードの代わりにトークンを貼り付け

「Password for 'https://KeijiSuetsugu@github.com':」と表示されたら：

1. **ステップ1でコピーしたトークンを貼り付け**
   - Command + V で貼り付け
   - ⚠️ トークンを全部貼り付ける（一部だけではない）
   - ⚠️ 余分なスペースや改行がないか確認

2. **Enterキーを押す**
   - ⚠️ 画面には何も表示されませんが、入力されています
   - これで正しく送信されます

### ステップ5: 成功を確認

以下のようなメッセージが表示されれば成功：

```
Enumerating objects: 22, done.
Counting objects: 100% (22/22), done.
Delta compression using up to 8 threads
Compressing objects: 100% (20/20), done.
Writing objects: 100% (22/22), 27.21 KiB | 4.54 MiB/s, done.
Total 22 (delta 1), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (1/1), done.
To https://github.com/KeijiSuetsugu/blog-auto-poster.git
 * [new branch]      main -> main
Branch 'main' set up to track remote 'main'.
```

## 🆘 まだエラーが出る場合

### 確認事項

1. ✅ **トークンを全部コピーしたか？**
   - `ghp_`で始まる長い文字列全体をコピー
   - 途中で切れていないか確認

2. ✅ **`repo`と`workflow`の両方にチェックを入れたか？**
   - トークン作成時に両方チェックされているか確認

3. ✅ **ユーザー名が正しいか？**
   - GitHubのユーザー名（URLに表示される名前）
   - 例：`https://github.com/KeijiSuetsugu` なら `KeijiSuetsugu`

4. ✅ **パスワードではなくトークンを入力したか？**
   - GitHubのパスワードではなく、Personal Access Tokenを入力

### もう一度最初から

1. 新しいトークンを作成（上記のステップ1を再度）
2. トークンを確実にコピー
3. ターミナルで認証情報をクリア
4. `git push origin main` を実行
5. ユーザー名とトークンを正確に入力

## 💡 ヒント

### トークンを確認する方法

トークンが正しくコピーできているか確認：
- トークンの長さ：約60-70文字くらい
- トークンの始まり：`ghp_`
- 余分なスペースがないか

### 入力時に注意すること

- ユーザー名：GitHubのユーザー名のみ（パスやメールアドレスではない）
- パスワード欄：トークンを貼り付け（通常のパスワードではない）
- 貼り付け後：Enterキーを押す前に、念のため確認

## ✅ まとめ

1. ✅ 新しいPersonal Access Tokenを作成（`repo`と`workflow`の両方にチェック）
2. ✅ トークンを全部コピー（一度しか表示されない）
3. ✅ ターミナルで認証情報をクリア
4. ✅ `git push origin main` を実行
5. ✅ ユーザー名とトークンを正確に入力

これで成功するはずです！






