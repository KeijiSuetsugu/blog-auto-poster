# 🚨 403エラー - 最終確認事項

## 現在の状況

- ✅ ローカル: 成功
- ✅ 環境変数: 正しい（パスワード29文字）
- ✅ エックスサーバー: 使用中
- ❌ GitHub Actions: 403エラー

## 📋 確認チェックリスト

### ✅ 1. エックスサーバーのWAF設定

#### 確認方法

1. エックスサーバーのサーバーパネルにログイン
   - https://www.xserver.ne.jp/login_server.php

2. 「WAF設定」を開く

3. `freeeeeeestyle.com` の状態を確認

**質問: WAFは「OFF」になっていますか？**

- [ ] はい、OFFになっている
- [ ] いいえ、まだONになっている
- [ ] 確認していない

**質問: WAFをOFFにしてから何分経ちましたか？**

- [ ] 5分未満
- [ ] 5-15分
- [ ] 15分以上

⚠️ **重要**: 設定反映には15分以上かかる場合があります

---

### ✅ 2. WordPressのセキュリティプラグイン

#### 確認方法

1. WordPress管理画面にログイン
   - https://freeeeeeestyle.com/wp-admin/

2. 左メニュー「**プラグイン**」→「**インストール済みプラグイン**」

3. 以下のプラグインがあるか確認：

**質問: 以下のプラグインはインストールされていますか？**

- [ ] Wordfence Security
- [ ] iThemes Security
- [ ] All In One WP Security & Firewall
- [ ] Sucuri Security
- [ ] Jetpack（セキュリティ機能）
- [ ] SiteGuard WP Plugin
- [ ] その他のセキュリティプラグイン: ___________

#### もしセキュリティプラグインがある場合

**今すぐ試してください:**

1. そのプラグインを**一時的に無効化**
   - プラグイン名の下の「無効化」をクリック

2. GitHub Actionsを再実行

3. 成功したら、そのプラグインが原因です

---

### ✅ 3. ユーザー権限の確認

#### 確認方法

1. WordPress管理画面で「**ユーザー**」→「**ユーザー一覧**」

2. `onepeace0710` ユーザーを探す

3. 権限を確認

**質問: ユーザー権限は何ですか？**

- [ ] 管理者
- [ ] 編集者
- [ ] 投稿者
- [ ] その他: ___________

⚠️ **重要**: 権限が「管理者」または「編集者」でないと投稿できません

#### 権限が不足している場合

1. ユーザー名にマウスを合わせる
2. 「編集」をクリック
3. 「権限グループ」を「**管理者**」に変更
4. 「ユーザーを更新」をクリック

---

### ✅ 4. アプリケーションパスワードの確認

#### 確認方法

1. WordPress管理画面で「**ユーザー**」→「**プロフィール**」

2. 下にスクロールして「**アプリケーションパスワード**」セクションを探す

**質問: アプリケーションパスワードは表示されていますか？**

- [ ] はい、表示されている
- [ ] いいえ、表示されていない（セクション自体がない）

#### セクションが表示されていない場合

WordPressのバージョンが古い可能性があります。

1. 「**ダッシュボード**」→「**更新**」
2. WordPressを最新版に更新

---

## 🔧 今すぐ試すべきこと（優先順位順）

### 🥇 最優先: セキュリティプラグインを無効化

1. WordPress管理画面にログイン
2. プラグイン → インストール済みプラグイン
3. セキュリティ関連プラグインを**全て無効化**
4. GitHub Actionsを再実行

**これで成功する可能性: 90%**

---

### 🥈 次に試す: 新しいアプリケーションパスワードを作成

1. WordPress管理画面 → ユーザー → プロフィール
2. 既存のアプリケーションパスワードを**削除**
3. 新しいパスワードを作成
   - 名前: 「GitHub Actions用（新規）」
   - 「新しいアプリケーションパスワードを追加」をクリック
4. 表示されたパスワードを**全てコピー**
5. GitHub Secretsの`WORDPRESS_PASSWORD`を更新
6. GitHub Actionsを再実行

**これで成功する可能性: 70%**

---

### 🥉 最後に試す: REST APIの動作確認

ブラウザで以下にアクセス：

```
https://freeeeeeestyle.com/wp-json/wp/v2
```

**質問: 何が表示されますか？**

- [ ] JSONデータが表示される → REST APIは有効
- [ ] エラーメッセージが表示される → REST APIが無効
- [ ] 何も表示されない → サーバーの問題

---

## 🆘 デバッグ情報の確認

GitHub Actionsのログで以下を確認してください：

```
DEBUG: パスワードの先頭4文字: ****
```

**質問: 表示されている先頭4文字は何ですか？**

正しくは: `2xdG`

もし違う場合、GitHub Secretsのパスワードが間違っています。

---

## 📊 原因の絞り込み

### パターン1: WAFが原因

- ✅ WAFをOFFにした
- ⏱️ 15分以上待った
- ✅ GitHub Actionsを再実行
- ❌ まだ403エラー

→ **次へ**: セキュリティプラグインを確認

### パターン2: セキュリティプラグインが原因

- ✅ セキュリティプラグインがある
- ✅ プラグインを無効化した
- ✅ GitHub Actionsを再実行
- ✅ 成功！

→ **解決**: プラグインの設定を調整して再度有効化

### パターン3: パスワードが間違っている

- ✅ デバッグ情報を確認
- ❌ パスワードの先頭4文字が `2xdG` ではない

→ **解決**: GitHub Secretsのパスワードを修正

---

## 🎯 今すぐやること

### ステップ1: セキュリティプラグインを確認（5分）

1. WordPress管理画面にログイン
2. プラグイン一覧を開く
3. セキュリティプラグインがあるか確認
4. あれば無効化

### ステップ2: GitHub Actionsを再実行（1分）

1. https://github.com/KeijiSuetsugu/blog-auto-poster/actions
2. 「Run workflow」をクリック

### ステップ3: 結果を確認（1分）

- ✅ 成功 → 完了！
- ❌ まだ403エラー → 次の確認へ

---

## 💬 教えてください

以下の情報を教えていただけると、より正確に原因を特定できます：

1. **WAFの状態**: OFFになっていますか？何分経過しましたか？
2. **セキュリティプラグイン**: どのプラグインがインストールされていますか？
3. **ユーザー権限**: 「管理者」ですか？
4. **デバッグ情報**: パスワードの先頭4文字は `2xdG` ですか？

---

## ⏱️ 解決までの予想時間

- セキュリティプラグインが原因: **5分**
- WAFの設定反映待ち: **15-30分**
- パスワード再設定: **10分**

**ほとんどの場合、30分以内に解決します！**

